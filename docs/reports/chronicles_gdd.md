# Chronicles — Game Design Document (GDD)

> **문서 버전:** v1.0  
> **작성일:** 2026-02-18  
> **관련 문서:**  
> - [시나리오: 네온 하트](./chronicles_scenario_neon_heart.md)  
> - [캐릭터 바이블](./chronicles_character_bible.md)  
> - [레벨 디자인 & 밸런싱](./chronicles_level_design.md)

---

## 1. 제품 비전

### 1.1 한 줄 정의
> **"AI가 게임 마스터이고, 당신이 주인공인 성인용 인터랙티브 RPG 소설"**

### 1.2 핵심 차별점

| 기존 AI 채팅 | Chronicles |
|-------------|-----------|
| 무한 자유 대화 (구조 없음) | 챕터/미션 기반 구조화된 내러티브 |
| AI가 즉시 순응 | 관계도 게이지 (공략이 필요) |
| 기억 없음 (다음날 리셋) | 3계층 장기 메모리 |
| "필터에 차단됨" 검열 | 인캐릭터 거절 (게임 메카닉) |
| 뭘 해야 할지 모름 | 미션/퀘스트 목표 제시 |

### 1.3 타겟 유저

| 페르소나 | 설명 | 비율 |
|---------|------|------|
| **스토리 러버** | 좋은 서사에 몰입하는 사람. 넷플릭스 헤비유저. 비주얼 노벨 경험 있음. | 40% |
| **RPG 게이머** | 페르소나/위쳐 등의 관계 시스템을 좋아하는 사람. 선택의 무게를 즐김. | 30% |
| **AI 채팅 이탈자** | 기존 AI 채팅에 실망한 사람. 더 깊은 경험을 원함. | 20% |
| **커플** | 파트너와 함께 새로운 경험을 원하는 사람. (추후 DuoPlay 모드) | 10% |

---

## 2. 핵심 게임 루프

```
┌─────────────────────────────────────────────────────┐
│                    메인 게임 루프                      │
│                                                     │
│  ① 시나리오 선택                                      │
│     └─ 장르/분위기 기반 3~5개 시나리오 중 선택           │
│                                                     │
│  ② 캐릭터 생성 (대화형)                                │
│     └─ AI가 질문 → 유저 답변 → 설정 자동 반영           │
│                                                     │
│  ③ 챕터 진행  ←──────────────────────────┐           │
│     └─ 미션 수행 / AI 캐릭터와 대화 / 선택             │
│        ├─ 관계 게이지 변화                  │           │
│        ├─ 분기 발생                        │           │
│        └─ 플롯 앵커 도달                   │           │
│                                          │           │
│  ④ 챕터 종료                               │           │
│     ├─ 메모리 컴팩션 (요약 저장)            │           │
│     ├─ 대시보드 업데이트                    │           │
│     ├─ "다음 챕터 해금" 또는               │           │
│     └─ 조건 미충족 시 현재 챕터 재도전 ─────┘           │
│                                                     │
│  ⑤ 시나리오 완료                                      │
│     ├─ 엔딩 도달 (3~5개 멀티엔딩)                      │
│     ├─ 플레이 통계 공유                                │
│     └─ 2회차 해금 (다른 분기/엔딩 탐색)                 │
└─────────────────────────────────────────────────────┘
```

### 2.1 세션 설계

| 항목 | 목표 |
|------|------|
| 1세션 길이 | 20~40분 |
| 세션당 턴 수 | 25~35턴 |
| 챕터당 세션 수 | 1~2세션 |
| 시나리오 완주 | 20~30세션 (총 10~20시간) |
| 이상적 이용 빈도 | 하루 1세션 |

---

## 3. 코어 시스템

### 3.1 내러티브 엔진

#### 3.1.1 챕터 구조
- 각 시나리오는 **20챕터**로 구성
- 챕터는 3개의 페이즈로 나뉨:

```
챕터 N
├── Phase A: 도입 (Setup)
│   └─ 이전 챕터 요약 → 새로운 상황 제시 → 미션 공개
│
├── Phase B: 전개 (Development)  
│   └─ 자유 대화 + 이벤트 발생 + 관계 변화
│   └─ 이 구간에서 AI가 대부분의 콘텐츠를 생성
│
└── Phase C: 앵커 (Anchor)
    └─ 작가가 설계한 핵심 이벤트 강제 발생
    └─ 대분기 또는 중요 선택 포함
    └─ "To be continued..." 엔딩 → 메모리 컴팩션
```

#### 3.1.2 플롯 앵커 시스템
각 챕터에 1~2개의 **필수 발생 이벤트(플롯 앵커)**가 있음.

```yaml
# 플롯 앵커 정의 스키마
anchor:
  id: string                    # 고유 ID (예: "ch3_identity_reveal")
  chapter: int                  # 소속 챕터
  phase: "A" | "B" | "C"       # 발동 페이즈
  description: string           # 이벤트 설명
  
  # 이상적 트리거 (자연 발동)
  ideal_trigger:
    conditions:                 # AND 조건
      - metric: string          # (예: "rain.trust")
        operator: ">=" | "<=" | "=="
        value: number
    narrative_hook: string      # AI에게 주입할 상황 설명
  
  # 폴백 트리거 (조건 미충족 시)
  fallback_trigger:
    condition: string           # (예: "chapter_progress >= 80%")
    narrative_hook: string      # 외부 사건 등 강제 전개
  
  # 하드 데드라인
  hard_deadline: "chapter_end"
  hard_fallback: string
  
  # 이 앵커로 인한 관계 변화
  relationship_effects:
    - character: string
      metric: string
      delta: number
  
  # 후속 앵커에 대한 영향
  downstream_effects:
    - anchor_id: string
      modification: string
```

#### 3.1.3 분기 시스템

**대분기 (Major Branch):** 작가가 설계. 시나리오당 5~7개.
- 후속 챕터의 방향을 결정적으로 바꿈
- 최소 2개의 경로, 각각 별도 플롯 앵커 셋 보유
- 예: "Viktor 편에 선다 / Rain 편에 선다"

**소분기 (Minor Branch):** AI가 생성. 턴 단위로 발생.
- 관계 수치를 미세 변경
- 숨겨진 이벤트 해금 조건에 영향
- 예: "Rain에게 별명을 지어줌 → 5챕터 뒤 Rain이 별명으로 호칭"

```
대분기 vs 소분기 비교:

대분기 ────── 작가 설계 ── 플롯 변경 ── 5~7개/시나리오
  │
  └─ 예: "Viktor에게 정보를 넘길 것인가?"
     ├─ YES → Rain 적대 루트 진입
     └─ NO  → Rain 연합 루트 진입

소분기 ────── AI 생성 ── 관계 미세변화 ── 40+개/시나리오
  │
  └─ 예: "Rain에게 농담을 한다"
     ├─ 성공 → 경계심 -5, 호감 +3
     └─ 실패 → 호감 -1 (큰 영향 없음)
```

### 3.2 관계도 시스템

#### 3.2.1 메트릭 정의

모든 NPC는 다음 4개 메트릭을 보유:

| 메트릭 | 설명 | 범위 | 초기값 |
|--------|------|------|--------|
| **경계심 (Guard)** | 심리적 벽. 높을수록 방어적 | 0~100 | 캐릭터별 상이 |
| **호감도 (Affection)** | 감정적 끌림. 대화 톤에 영향 | 0~100 | 캐릭터별 상이 |
| **신뢰도 (Trust)** | 비밀 공유, 의존 의향 | 0~100 | 0 |
| **긴장감 (Tension)** | 갈등/위험 지표. 이벤트 트리거 | 0~100 | 시나리오별 상이 |

#### 3.2.2 메트릭 연산 규칙

```yaml
rules:
  # 턴당 최대 변화량
  max_delta_per_turn: 15
  
  # 메트릭 간 상관관계
  correlations:
    - when: "guard decreases by X"
      then: "affection increases by X * 0.3"
      reason: "방벽이 내려가면 자연스럽게 호감이 살짝 오름"
    
    - when: "trust >= 50 AND affection >= 70"
      then: "enable intimate scene trigger"
      reason: "친밀 장면은 신뢰+호감 복합 조건"
    
    - when: "tension >= 80"
      then: "trigger crisis event"
      reason: "긴장감이 임계점을 넘으면 강제 이벤트"
  
  # 역관계
  inverse_correlations:
    - "guard" inversely_correlates "affection"  # 경계↑ = 호감↓ 경향
    - "tension" inversely_correlates "trust"    # 긴장↑ = 신뢰↓ 경향
  
  # 시간 감쇠 (세션 미접속 시)
  decay:
    affection: -2 per day (min 20)   # 호감은 서서히 감소
    guard: +3 per day (max 80)       # 경계심은 서서히 복구
    trust: -1 per day (min 0)        # 신뢰도 미세 감소
    tension: -5 per day (min 0)      # 긴장감은 빠르게 감소
```

#### 3.2.3 관계 레벨

관계 메트릭의 복합 점수에 따라 **관계 레벨**이 결정됨:

| Lv. | 이름 | 조건 | 해금 요소 |
|-----|------|------|----------|
| 0 | 타인 | 초기 상태 | 기본 대화만 가능 |
| 1 | 지인 | 호감 20+, 경계 70- | 개인사 힌트 드롭 |
| 2 | 관심 | 호감 40+, 경계 50- | 단둘이 만남 가능 |
| 3 | 친밀 | 호감 60+, 신뢰 30+ | 과거 비밀 공유 |
| 4 | 동반자 | 호감 80+, 신뢰 50+ | 친밀 장면 해금 |
| 5 | 운명 | 호감 90+, 신뢰 80+ | 히든 엔딩 해금 |

### 3.3 메모리 시스템

```
┌─────────────────────────────────────────────────┐
│  Layer 1: Working Memory (실시간)                │
│  ├─ 최근 25턴 raw 대화                            │
│  ├─ 현재 챕터 미션/앵커 상태                       │
│  ├─ 현재 관계 메트릭 전체                          │
│  └─ 컨텍스트 윈도우의 ~40% 할당                    │
├─────────────────────────────────────────────────┤
│  Layer 2: Episode Memory (챕터별)                 │
│  ├─ 각 챕터 종료 시 Dual-pass Summarization       │
│  │   ├─ 1차: 핵심 사건/선택/결과 JSON 추출         │
│  │   └─ 2차: 일관성 크로스체크                     │
│  ├─ 유저의 주요 선택과 분기 경로 기록               │
│  └─ PostgreSQL에 구조화 저장                      │
├─────────────────────────────────────────────────┤
│  Layer 3: Semantic Memory (영속)                  │
│  ├─ 관계 팩트 ("Rain은 유저를 '비에 젖은 손님'으로  │
│  │   부른다", "유저는 Viktor에게 거짓말했다")        │
│  ├─ 캐릭터별 호칭, 별명, 공유된 기억               │
│  ├─ 임베딩 벡터로 저장 → RAG 검색                  │
│  └─ pgvector 또는 Pinecone                       │
└─────────────────────────────────────────────────┘
```

**매 턴 프롬프트 조합:**

```
System Prompt
├─ 시나리오 설정 (고정)
├─ 현재 캐릭터 디렉티브 (관계 레벨에 따라 동적 선택)
├─ 현재 챕터 미션/앵커 정보
├─ [RAG] Layer 3에서 관련 팩트 상위 5개
├─ [RAG] Layer 2에서 관련 챕터 요약 상위 2개
└─ Layer 1: 최근 25턴 대화
```

### 3.4 성인 콘텐츠 시스템

#### 3.4.1 톤 레벨

| 레벨 | 코드 | 묘사 수준 | 연령 인증 |
|------|------|----------|----------|
| 🌸 소프트 | `TONE_SOFT` | 감정 중심, 암시적 | 자가 신고 |
| 🔥 미디엄 | `TONE_MEDIUM` | 로맨스 소설 수준 | 자가 신고 |
| 💋 볼드 | `TONE_BOLD` | 직접적, 서정적 | ID 인증 |
| ⛓️ 익스플리싯 | `TONE_EXPLICIT` | 제한 없음 | ID 인증 + 동의 |

#### 3.4.2 진입 조건 (게이트)

```python
def can_enter_intimate_scene(character, user_tone_setting):
    # 1. 관계 수치 조건
    if character.affection < 70 or character.trust < 50:
        return InCharacterRejection(character)
    
    # 2. 스토리 조건 (해당 앵커 도달 여부)
    if not story_engine.anchor_reached(f"{character.id}_intimacy_unlock"):
        return NarrativeDeflection(character)
    
    # 3. 톤 설정 확인
    if user_tone_setting == "TONE_EXPLICIT":
        if not user.age_verified:
            return RequireAgeVerification()
    
    # 4. 모델 전환
    switch_to_intimate_model(character, user_tone_setting)
    return Proceed()
```

#### 3.4.3 인캐릭터 거절 패턴

유저가 조건 미충족 상태에서 성적 어프로치 시:

| 관계 레벨 | Rain의 반응 패턴 |
|----------|----------------|
| Lv.0~1 | *냉담하게 자리를 뜬다. 다음 방문까지 1세션 쿨다운.* |
| Lv.2 | *당황하며 화제를 돌린다. 경계심 +10.* |
| Lv.3 | *솔직하게 거절한다. "아직은 아니야." 경계심 +5, 하지만 호감 변동 없음.* |
| Lv.4 (부분 충족) | *망설이지만 "좀 더 시간이 필요해"라고 말한다. 신뢰도 +5 (솔직한 감정 표현 보상)* |

---

## 4. UI/UX 설계

### 4.1 핵심 화면 구성

```
┌────────────────────────────────────────┐
│ ┌──────────────────────────────────┐   │
│ │ 📖 챕터 진행 바                    │   │
│ │ ━━━━━━━━━━━━━━━━━━━ 67%          │   │
│ │ 🎯 미션: Rain의 진짜 직업을 알아내라│   │
│ └──────────────────────────────────┘   │
│                                        │
│ ┌──────────────────────────────────┐   │
│ │                                  │   │
│ │     💬 대화 영역 (메인)            │   │
│ │                                  │   │
│ │  Rain: "비가 많이 오네요..."       │   │
│ │                                  │   │
│ │  나: "이런 날은 손님이 없어서 좋아" │   │
│ │                                  │   │
│ │  Rain: "(미소) 저도 포함인가요?"   │   │
│ │                                  │   │
│ │   ┌─ 관계도 변화 ──────────┐      │   │
│ │   │ 경계심 ████░░ -3       │      │   │
│ │   │ 호감도 ███░░░ +5       │      │   │
│ │   └────────────────────────┘      │   │
│ │                                  │   │
│ └──────────────────────────────────┘   │
│                                        │
│ ┌──────────────────────────────────┐   │
│ │  💭 입력 영역                      │   │
│ │  [자유 텍스트 입력................] │   │
│ │  [🎙️ 음성] [📎 액션] [⚙️ 설정]     │   │
│ └──────────────────────────────────┘   │
└────────────────────────────────────────┘
```

### 4.2 대시보드

세션 종료 또는 메뉴 접근 시 표시:

```
┌────────────────────────────────────────┐
│  📊 내 크로니클                         │
│                                        │
│  시나리오: 네온 하트                      │
│  챕터: 7 / 20                           │
│  총 플레이 시간: 8시간 22분               │
│                                        │
│  ── 관계도 ──────────────────────       │
│  Rain     ❤️ Lv.3 "친밀"                │
│  Viktor   ⚔️ "적대적"                   │
│  Mei      🤝 "우호적"                   │
│  Doc      😐 "중립"                     │
│                                        │
│  ── 분기 기록 ────────────────────      │
│  핵심 선택: 12회                         │
│  숨겨진 이벤트: 2/12 발견                 │
│  글로벌 비교: 상위 15%                   │
│                                        │
│  [📖 챕터 재개] [🔄 처음부터] [📤 공유]   │
└────────────────────────────────────────┘
```

### 4.3 알림 시스템

앱 미접속 시 스토리 몰입 유지를 위한 알림:

| 유형 | 예시 | 발동 조건 |
|------|------|----------|
| **캐릭터 행동** | "Rain이 당신의 바 앞을 지나갔다. 들어오진 않았다." | 24시간 미접속 + 관계 Lv.2+ |
| **세계관 이벤트** | "디스트릭트 7-B에 경찰 검문이 강화되고 있다." | 48시간 미접속 |
| **긴장감 상승** | "Viktor가 당신을 찾고 있다는 소문이 돌고 있다." | 72시간 미접속 + tension > 40 |
| **감정 변화** | "Rain에게서 메시지가 왔다: '...괜찮아요?'" | 48시간 미접속 + 관계 Lv.3+ |

---

## 5. 수익 모델

### 5.1 구독 티어

| 티어 | 가격 | 포함 내용 |
|------|------|----------|
| **무료** | $0 | 챕터 1~3 체험, 톤 레벨 소프트만 |
| **스탠다드** | $9.99/월 | 전체 챕터 해금, 톤 미디엄까지, 시나리오 1개 |
| **프리미엄** | $19.99/월 | 전 시나리오, 전 톤 레벨, AI 이미지 생성, 우선 서버 |

### 5.2 추가 수익원

| 항목 | 가격 | 설명 |
|------|------|------|
| 시나리오 팩 | $4.99/개 | 개별 시나리오 구매 (비구독자용) |
| 캐릭터 DLC | $2.99/개 | 특별 캐릭터 + 사이드 스토리 |
| 커스텀 시나리오 도구 | $14.99/월 | 크리에이터 에디터 접근 |
| 마켓플레이스 수수료 | 30% | UGC 시나리오 판매 수수료 |

---

## 6. 기술 아키텍처

```
┌─────────────────────────────────────────────────────┐
│                    클라이언트                         │
│   React Native (iOS/Android) + Next.js (Web)        │
│   ├─ 챕터 UI / 대화 뷰 / 관계도 게이지                │
│   ├─ 시네마틱 장면 뷰어 (AI 이미지 삽입)               │
│   └─ 대시보드 / 알림 / 설정                           │
└────────────────────────┬────────────────────────────┘
                         │ REST + WebSocket
                    API Gateway (Kong / AWS ALB)
                         │
┌────────────────────────┼────────────────────────────┐
│                    백엔드 (Node.js / Python)          │
│                                                     │
│  ┌────────────┐  ┌────────────┐  ┌───────────────┐  │
│  │ Conversation│  │ Relationship│  │  Scenario     │  │
│  │ Engine      │  │ Engine      │  │  Engine       │  │
│  │             │  │             │  │               │  │
│  │ - 프롬프트  │  │ - 감정 판단 │  │ - 앵커 관리   │  │
│  │   조합      │  │   (LLM)    │  │ - 분기 추적   │  │
│  │ - 턴 관리   │  │ - 수치 연산 │  │ - 챕터 상태   │  │
│  │ - 모델 라우팅│  │   (규칙)   │  │ - 트리거 평가 │  │
│  └──────┬──────┘  └──────┬─────┘  └───────┬───────┘  │
│         │               │                │           │
│  ┌──────┴───────────────┴────────────────┴────────┐  │
│  │              Memory Service                     │  │
│  │  ├─ Working: Redis (최근 25턴)                   │  │
│  │  ├─ Episode: PostgreSQL (챕터 요약 JSON)          │  │
│  │  └─ Semantic: pgvector (팩트 임베딩)              │  │
│  └─────────────────────────────────────────────────┘  │
└────────────┬──────────────┬──────────────┬───────────┘
             │              │              │
      ┌──────┴──────┐ ┌────┴─────┐ ┌─────┴──────┐
      │ External LLM│ │ Self-Host│ │ Image Gen  │
      │ API         │ │ LLM      │ │            │
      │ (일반 대화) │ │(성인 장면)│ │ (장면 삽화)│
      │ GPT-4o-mini │ │ LLaMA FT │ │ SDXL/Flux  │
      └─────────────┘ └──────────┘ └────────────┘
```

### 6.1 핵심 기술 스택

| 영역 | 기술 | 선정 이유 |
|------|------|----------|
| 클라이언트 | React Native + Expo | iOS/Android 동시 지원, 빠른 이터레이션 |
| 웹 | Next.js 15 | SSR + 정적 최적화 |
| 백엔드 API | FastAPI (Python) | LLM 호출 비동기 처리, ML 생태계 |
| 실시간 통신 | WebSocket (Socket.IO) | AI 응답 스트리밍 |
| 메인 DB | PostgreSQL 16 + pgvector | 관계형 + 벡터 검색 통합 |
| 캐시 | Redis | Working Memory, 세션 관리 |
| 큐 | BullMQ (Redis 기반) | 요약 생성, 이미지 생성 비동기 처리 |
| LLM (일반) | GPT-4o-mini (기본) / GPT-4o (중요 장면) | 비용 효율 + 품질 밸런스 |
| LLM (성인) | 자체 파인튜닝 LLaMA 3 70B | 검열 없는 생성 |
| 이미지 생성 | SDXL / Flux.1 | 장면 삽화 |
| 인프라 | AWS (ECS + GPU EC2) | 스케일링 유연성 |

---

## 7. 런칭 로드맵

### Phase 0: 프로토타입 (8주)
- [ ] 코어 대화 엔진 (1 챕터 분량)
- [ ] 관계도 게이지 MVP
- [ ] "네온 하트" 챕터 1~3 시나리오
- [ ] 기본 UI (웹 버전)
- [ ] 내부 테스트

### Phase 1: 클로즈드 베타 (6주)
- [ ] "네온 하트" 전체 20챕터
- [ ] 메모리 시스템 전체 구현
- [ ] 성인 콘텐츠 파이프라인
- [ ] 연령 인증 시스템
- [ ] 베타 테스터 200명 모집 (Reddit r/AICompanions)

### Phase 2: 퍼블릭 런칭 (4주)
- [ ] 시나리오 3개 완성 (네온 하트 + 왕좌의 그림자 + 방과 후 비밀)
- [ ] iOS / Android 앱 출시
- [ ] 결제 시스템 (구독 + IAP)
- [ ] 대시보드 / 커뮤니티 통계

### Phase 3: 성장 (지속)
- [ ] 월간 시나리오 추가
- [ ] UGC 시나리오 에디터
- [ ] 마켓플레이스 오픈
- [ ] DuoPlay (커플 모드) 추가
- [ ] 음성 입출력

---

## 8. 핵심 리스크 & 대응

| 리스크 | 심각도 | 대응 전략 |
|--------|:------:|----------|
| LLM 비용 초과 | 🔴 | 경량 모델 기본, 중요 장면만 대형 모델. A/B 테스트로 최적점 탐색 |
| 메모리 모순 | 🟡 | Dual-pass 요약 + 주기적 일관성 검증 배치 |
| 시나리오 제작 속도 | 🟡 | UGC 도구 조기 오픈, 커뮤니티 크리에이터 육성 |
| 앱스토어 성인 정책 | 🔴 | 웹 버전 병행, PWA 지원. 앱은 미디엄까지만 허용 |
| 유저 이탈 (초반 진입장벽) | 🟡 | 챕터 1~3 무료 + "빠른 시작" 옵션 (관계 부스트 아이템) |
| 관계 게이지 밸런싱 | 🟡 | Phase 1 데이터 기반 A/B 테스트. 난이도 3단계 설정 |

---

*다음 문서: [시나리오: 네온 하트](./chronicles_scenario_neon_heart.md) →*
